Name: Deploy
SchemaVersion: "1.0"
Triggers:
  - Type: Push
    Branches:
      - main
Actions:
  DeployDevelopment:
    Identifier: aws/build@v1.0.0
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: LAUNCH_OPTIONS_region
          Value: us-west-2
    Configuration:
      Steps:
        - Run: export AWS_REGION=$LAUNCH_OPTIONS_region
        - Run: npm ci
        - Run: npx cdk bootstrap
        - Run: npx cdk deploy instance-scheduler-on-aws --require-approval never
      Container:
        Registry: CODECATALYST
        Image: CodeCatalystLinux_x86_64:2024_03
    Compute:
      Type: EC2
      Fleet: Linux.x86-64.Large
    Timeout: 60
    Environment:
      Name: development
